<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ボタン記録テスト</title>
    <style>
        body { font-family: sans-serif; text-align: center; margin-top: 50px; }
        /* ボタンのデザイン */
        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:active { background-color: #0056b3; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>時刻記録システム</h1>
    <p>ボタンを押すとスプレッドシートのA1に現在時刻が記録されます。</p>
    
    <button id="recordBtn" onclick="sendData()">記録する</button>
    <p id="status"></p>

    <script>
        function sendData() {
            // ★ここに先ほどのGASのウェブアプリURLを貼り付けてください
            const gasUrl = "https://script.google.com/macros/s/AKfycbw1YkiTDzwzO95yFZx7atdjB7G7wgskRdTASHh86TTPPfnrZnSKQt7DTBNPQRDfwNBdXA/exec";

            const btn = document.getElementById("recordBtn");
            const status = document.getElementById("status");

            // 連打防止のためボタンを一時的に無効化
            btn.disabled = true;
            status.textContent = "送信中...";

            // GASにデータを送る設定
            // mode: 'no-cors' が重要です。これがないとエラーになります。
            fetch(gasUrl, {
                method: "POST",
                mode: "no-cors", 
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(() => {
                status.textContent = "記録しました！";
                status.style.color = "green";
                // 3秒後にボタンを復活
                setTimeout(() => {
                    btn.disabled = false;
                    status.textContent = "";
                }, 3000);
            })
            .catch(error => {
                console.error('Error:', error);
                status.textContent = "エラーが発生しました";
                status.style.color = "red";
                btn.disabled = false;
            });
        }
    </script>
</body>
</html>